<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Сверка платежей Amazon - Jabka Transportation</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // Lucide Icons as SVG components
        const Upload = () => (
            <svg className="w-12 h-12 text-indigo-600 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
            </svg>
        );

        const FileText = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
        );

        const CheckCircle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const XCircle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const AlertCircle = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const Download = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
        );

        const Info = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
        );

        const PaymentReconciliation = () => {
            const [dispatcherFile, setDispatcherFile] = useState(null);
            const [amazonFiles, setAmazonFiles] = useState([]);
            const [results, setResults] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState('');
            const [log, setLog] = useState([]);

            const addLog = (message) => {
                setLog(prev => [...prev, `${new Date().toLocaleTimeString()}: ${message}`]);
            };

            const readExcelFile = (file) => {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = new Uint8Array(e.target.result);
                            const workbook = XLSX.read(data, { type: 'array' });
                            resolve(workbook);
                        } catch (err) {
                            reject(err);
                        }
                    };
                    reader.onerror = reject;
                    reader.readAsArrayBuffer(file);
                });
            };

            const parseDate = (dateValue) => {
                if (!dateValue) return null;
                
                if (typeof dateValue === 'number') {
                    const date = XLSX.SSF.parse_date_code(dateValue);
                    return new Date(date.y, date.m - 1, date.d);
                }
                
                if (typeof dateValue === 'string') {
                    const parts = dateValue.split('/');
                    if (parts.length === 3) {
                        return new Date(parts[2], parts[0] - 1, parts[1]);
                    }
                }
                
                return null;
            };

            const findAmazonSheetByDate = (workbook, startDate, endDate) => {
                for (let sheetName of workbook.SheetNames) {
                    const datePattern = /(\d{1,2})\/(\d{1,2})-(\d{1,2})\/(\d{1,2})/;
                    const match = sheetName.match(datePattern);
                    
                    if (match) {
                        const startMonth = parseInt(match[1]);
                        const startDay = parseInt(match[2]);
                        const endMonth = parseInt(match[3]);
                        const endDay = parseInt(match[4]);
                        const year = startDate.getFullYear();
                        
                        const sheetStartDate = new Date(year, startMonth - 1, startDay);
                        const sheetEndDate = new Date(year, endMonth - 1, endDay);
                        
                        if (startDate >= sheetStartDate && endDate <= sheetEndDate) {
                            return sheetName;
                        }
                    }
                }
                
                return null;
            };

            const searchInAmazonSheet = (sheet, searchValue, isTrip) => {
                const results = [];
                const range = XLSX.utils.decode_range(sheet['!ref']);
                
                for (let rowIndex = 1; rowIndex <= range.e.r; rowIndex++) {
                    const cellC = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 2 })];
                    const tripId = cellC ? String(cellC.v).trim() : '';
                    
                    const cellD = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 3 })];
                    const loadId = cellD ? String(cellD.v).trim() : '';
                    
                    const cellS = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 18 })];
                    const amount = cellS ? parseFloat(cellS.v) || 0 : 0;
                    
                    if (!tripId && !loadId) continue;
                    if (tripId === 'TRIP ID' || tripId === 'QWERTY' || loadId === 'LOAD ID') continue;
                    
                    if (isTrip) {
                        if (tripId === searchValue) {
                            results.push({
                                rowIndex: rowIndex + 1,
                                amount,
                                tripId,
                                loadId
                            });
                        }
                    } else {
                        if (loadId === searchValue) {
                            results.push({
                                rowIndex: rowIndex + 1,
                                amount,
                                tripId,
                                loadId
                            });
                        }
                    }
                }
                
                return results;
            };

            const parseDispatcherData = (workbook) => {
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const range = XLSX.utils.decode_range(sheet['!ref']);
                addLog(`Диапазон данных диспетчеров: ${sheet['!ref']}`);
                
                const parsed = [];
                
                for (let rowIndex = 14; rowIndex <= range.e.r; rowIndex++) {
                    const cellC = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 2 })];
                    const idValue = cellC ? String(cellC.v).trim() : '';
                    
                    if (!idValue || idValue === 'QWERTY' || idValue === 'EMPTY') continue;
                    
                    const cellH = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 7 })];
                    const startDate = cellH ? parseDate(cellH.v) : null;
                    
                    const cellI = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 8 })];
                    const endDate = cellI ? parseDate(cellI.v) : null;
                    
                    const cellN = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 13 })];
                    let amount = 0;
                    if (cellN) {
                        if (typeof cellN.v === 'number') {
                            amount = cellN.v;
                        } else if (typeof cellN.v === 'string') {
                            amount = parseFloat(cellN.v.replace(/[$,\s]/g, '')) || 0;
                        } else if (cellN.w) {
                            amount = parseFloat(cellN.w.replace(/[$,\s]/g, '')) || 0;
                        }
                    }
                    
                    const cellL = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 11 })];
                    const dispatcherName = cellL ? String(cellL.v) : '';
                    
                    const cellA = sheet[XLSX.utils.encode_cell({ r: rowIndex, c: 0 })];
                    const carrierName = cellA ? String(cellA.v) : '';
                    
                    const isTrip = idValue.startsWith('T-');
                    
                    addLog(`  Строка ${rowIndex + 1}: ${idValue} (${isTrip ? 'Trip' : 'Load'}) - ${amount} | Даты: ${startDate ? startDate.toLocaleDateString() : 'N/A'} - ${endDate ? endDate.toLocaleDateString() : 'N/A'}`);
                    
                    parsed.push({
                        rowIndex: rowIndex + 1,
                        idValue,
                        isTrip,
                        startDate,
                        endDate,
                        amount,
                        carrierName,
                        dispatcherName
                    });
                }
                
                return parsed;
            };

            const reconcileData = (dispatcherData, amazonWorkbooks) => {
                const results = [];
                
                dispatcherData.forEach((dispatch, index) => {
                    addLog(`Обработка ${index + 1}/${dispatcherData.length}: ${dispatch.idValue}`);
                    
                    let status = 'Null';
                    let amazonTotal = 0;
                    let foundOnSheet = '';
                    let foundInFile = '';
                    let notes = '';
                    let matchedRows = [];
                    
                    for (let fileInfo of amazonWorkbooks) {
                        const { filename, workbook } = fileInfo;
                        
                        let targetSheet = null;
                        let targetSheetName = '';
                        
                        if (dispatch.startDate && dispatch.endDate) {
                            targetSheetName = findAmazonSheetByDate(workbook, dispatch.startDate, dispatch.endDate);
                            if (targetSheetName) {
                                targetSheet = workbook.Sheets[targetSheetName];
                                addLog(`  Проверяем файл: ${filename}, лист: ${targetSheetName}`);
                            }
                        }
                        
                        const sheetsToSearch = targetSheet ? [{ name: targetSheetName, sheet: targetSheet }] : 
                            workbook.SheetNames.map(name => ({ name, sheet: workbook.Sheets[name] }));
                        
                        for (let sheetInfo of sheetsToSearch) {
                            const searchResults = searchInAmazonSheet(sheetInfo.sheet, dispatch.idValue, dispatch.isTrip);
                            
                            if (searchResults.length > 0) {
                                foundOnSheet = sheetInfo.name;
                                foundInFile = filename;
                                matchedRows = searchResults.map(r => `Строка ${r.rowIndex}: $${r.amount.toFixed(2)}`);
                                amazonTotal = searchResults.reduce((sum, r) => sum + r.amount, 0);
                                addLog(`  ✓ Найдено ${searchResults.length} результатов в ${filename} на листе ${sheetInfo.name}, сумма: $${amazonTotal.toFixed(2)}`);
                                break;
                            }
                        }
                        
                        if (amazonTotal > 0) break;
                    }
                    
                    if (amazonTotal > 0) {
                        const difference = Math.abs(dispatch.amount - amazonTotal);
                        
                        if (difference < 0.02) {
                            status = 'Correct';
                            notes = `Файл: ${foundInFile}, Лист: ${foundOnSheet}`;
                        } else {
                            status = 'Incorrect';
                            notes = `Разница: $${difference.toFixed(2)} (${foundInFile}, ${foundOnSheet})`;
                        }
                    } else {
                        notes = 'Не найдено в файлах Amazon';
                    }
                    
                    results.push({
                        ...dispatch,
                        amazonTotal,
                        difference: Math.abs(dispatch.amount - amazonTotal),
                        status,
                        notes,
                        foundOnSheet,
                        foundInFile,
                        matchedRows
                    });
                });
                
                return results;
            };

            const handleReconcile = async () => {
                if (!dispatcherFile || amazonFiles.length === 0) {
                    setError('Пожалуйста, загрузите файл диспетчеров и хотя бы один файл Amazon');
                    return;
                }

                setLoading(true);
                setError('');
                setLog([]);

                try {
                    addLog('Начало обработки файлов...');
                    
                    const dispatcherWorkbook = await readExcelFile(dispatcherFile);
                    addLog('✓ Файл диспетчеров загружен');
                    addLog(`  Листы: ${dispatcherWorkbook.SheetNames.join(', ')}`);
                    
                    const amazonWorkbooks = [];
                    for (let file of amazonFiles) {
                        const workbook = await readExcelFile(file);
                        amazonWorkbooks.push({ filename: file.name, workbook });
                        addLog(`✓ Файл Amazon загружен: ${file.name}`);
                        addLog(`  Листы: ${workbook.SheetNames.join(', ')}`);
                    }

                    const dispatcherData = parseDispatcherData(dispatcherWorkbook);
                    addLog(`\n✓ Найдено записей диспетчеров: ${dispatcherData.length}\n`);

                    const reconciled = reconcileData(dispatcherData, amazonWorkbooks);
                    
                    setResults(reconciled);
                    addLog('\n✅ Сверка завершена!');
                } catch (err) {
                    setError(`Ошибка: ${err.message}`);
                    addLog(`❌ ОШИБКА: ${err.message}`);
                    console.error(err);
                } finally {
                    setLoading(false);
                }
            };

            const downloadResults = () => {
                if (!results) return;

                const ws = XLSX.utils.json_to_sheet(results.map(r => ({
                    'Row': r.rowIndex,
                    'Trip/Load ID': r.idValue,
                    'Type': r.isTrip ? 'Trip' : 'Load',
                    'Carrier': r.carrierName,
                    'Start Date': r.startDate ? r.startDate.toLocaleDateString() : '',
                    'End Date': r.endDate ? r.endDate.toLocaleDateString() : '',
                    'Jabka Amount': r.amount.toFixed(2),
                    'Amazon Amount': r.amazonTotal.toFixed(2),
                    'Difference': r.difference.toFixed(2),
                    'Status': r.status,
                    'Found In File': r.foundInFile,
                    'Found On Sheet': r.foundOnSheet,
                    'Notes': r.notes
                })));

                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, 'Reconciliation Results');
                XLSX.writeFile(wb, `Reconciliation_${new Date().toISOString().split('T')[0]}.xlsx`);
            };

            const getStatusIcon = (status) => {
                switch(status) {
                    case 'Correct':
                        return <CheckCircle className="w-5 h-5 text-green-500" />;
                    case 'Incorrect':
                        return <XCircle className="w-5 h-5 text-red-500" />;
                    default:
                        return <AlertCircle className="w-5 h-5 text-gray-400" />;
                }
            };

            const getStatusColor = (status) => {
                switch(status) {
                    case 'Correct':
                        return 'bg-green-50';
                    case 'Incorrect':
                        return 'bg-red-50';
                    default:
                        return 'bg-gray-50';
                }
            };

            const stats = results ? {
                correct: results.filter(r => r.status === 'Correct').length,
                incorrect: results.filter(r => r.status === 'Incorrect').length,
                null: results.filter(r => r.status === 'Null').length,
                total: results.length
            } : null;

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 p-6">
                    <div className="max-w-7xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-xl p-8 mb-6">
                            <div className="flex items-center gap-3 mb-6">
                                <FileText className="w-8 h-8 text-indigo-600" />
                                <h1 className="text-3xl font-bold text-gray-800">
                                    Сверка платежей Amazon - Jabka Transportation
                                </h1>
                            </div>
                            
                            <div className="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                                <div className="flex items-start gap-2">
                                    <Info className="w-5 h-5 text-blue-600 mt-0.5" />
                                    <div className="text-sm text-blue-800">
                                        <p className="font-semibold mb-2">Как работает сверка:</p>
                                        <ul className="list-disc ml-5 space-y-1">
                                            <li>Берем Trip ID или Load ID из столбца C (строка 15+) файла диспетчеров</li>
                                            <li>Смотрим на даты начала (столбец H) и окончания (столбец I)</li>
                                            <li>Ищем соответствующий лист в файлах Amazon по периоду дат</li>
                                            <li>Находим все совпадения в столбцах C (Trip ID) или D (Load ID)</li>
                                            <li>Суммируем значения из столбца S (для Trip ID может быть несколько строк)</li>
                                            <li>Сравниваем с суммой из столбца N файла диспетчеров</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div className="grid md:grid-cols-2 gap-6 mb-6">
                                <div className="border-2 border-dashed border-indigo-300 rounded-xl p-6 bg-indigo-50 hover:bg-indigo-100 transition-colors">
                                    <label className="block cursor-pointer">
                                        <div className="flex flex-col items-center">
                                            <Upload />
                                            <span className="text-lg font-semibold text-gray-700 mb-2">
                                                Файл диспетчеров (Jabka)
                                            </span>
                                            <span className="text-xs text-gray-500 mb-2">Столбец C: Trip/Load ID, H-I: Даты, N: Сумма</span>
                                            {dispatcherFile && (
                                                <span className="text-sm text-green-600 font-medium">
                                                    ✓ {dispatcherFile.name}
                                                </span>
                                            )}
                                        </div>
                                        <input
                                            type="file"
                                            accept=".xlsx,.xls"
                                            onChange={(e) => setDispatcherFile(e.target.files[0])}
                                            className="hidden"
                                        />
                                    </label>
                                </div>

                                <div className="border-2 border-dashed border-indigo-300 rounded-xl p-6 bg-indigo-50 hover:bg-indigo-100 transition-colors">
                                    <label className="block cursor-pointer">
                                        <div className="flex flex-col items-center">
                                            <Upload />
                                            <span className="text-lg font-semibold text-gray-700 mb-2">
                                                Файлы Amazon (можно несколько)
                                            </span>
                                            <span className="text-xs text-gray-500 mb-2">Столбец C: Trip ID, D: Load ID, S: Сумма</span>
                                            {amazonFiles.length > 0 && (
                                                <div className="text-sm text-green-600 font-medium mt-2">
                                                    <div>✓ Загружено файлов: {amazonFiles.length}</div>
                                                    {amazonFiles.map((f, idx) => (
                                                        <div key={idx} className="text-xs mt-1">{f.name}</div>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                        <input
                                            type="file"
                                            accept=".xlsx,.xls"
                                            multiple
                                            onChange={(e) => setAmazonFiles(Array.from(e.target.files))}
                                            className="hidden"
                                        />
                                    </label>
                                </div>
                            </div>

                            {error && (
                                <div className="bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-4">
                                    {error}
                                </div>
                            )}

                            <button
                                onClick={handleReconcile}
                                disabled={!dispatcherFile || amazonFiles.length === 0 || loading}
                                className="w-full bg-indigo-600 text-white py-4 rounded-xl font-semibold text-lg hover:bg-indigo-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors shadow-lg hover:shadow-xl"
                            >
                                {loading ? 'Обработка...' : 'Начать сверку'}
                            </button>
                        </div>

                        {log.length > 0 && (
                            <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4">Журнал обработки</h2>
                                <div className="bg-gray-900 rounded-lg p-4 max-h-48 overflow-y-auto">
                                    {log.map((entry, idx) => (
                                        <div key={idx} className="text-xs text-green-400 font-mono">{entry}</div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {stats && (
                            <div className="bg-white rounded-2xl shadow-xl p-6 mb-6">
                                <h2 className="text-xl font-bold text-gray-800 mb-4">Статистика</h2>
                                <div className="grid grid-cols-4 gap-4">
                                    <div className="bg-blue-50 p-4 rounded-lg">
                                        <div className="text-3xl font-bold text-blue-600">{stats.total}</div>
                                        <div className="text-sm text-gray-600">Всего записей</div>
                                    </div>
                                    <div className="bg-green-50 p-4 rounded-lg">
                                        <div className="text-3xl font-bold text-green-600">{stats.correct}</div>
                                        <div className="text-sm text-gray-600">Correct</div>
                                    </div>
                                    <div className="bg-red-50 p-4 rounded-lg">
                                        <div className="text-3xl font-bold text-red-600">{stats.incorrect}</div>
                                        <div className="text-sm text-gray-600">Incorrect</div>
                                    </div>
                                    <div className="bg-gray-50 p-4 rounded-lg">
                                        <div className="text-3xl font-bold text-gray-600">{stats.null}</div>
                                        <div className="text-sm text-gray-600">Null</div>
                                    </div>
                                </div>
                                
                                <button
                                    onClick={downloadResults}
                                    className="mt-4 w-full bg-green-600 text-white py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors flex items-center justify-center gap-2"
                                >
                                    <Download className="w-5 h-5" />
                                    Скачать результаты (Excel)
                                </button>
                            </div>
                        )}

                        {results && (
                            <div className="bg-white rounded-2xl shadow-xl overflow-hidden">
                                <div className="overflow-x-auto">
                                    <table className="w-full">
                                        <thead className="bg-indigo-600 text-white">
                                            <tr>
                                                <th className="px-4 py-3 text-left text-sm font-semibold">Статус</th>
                                                <th className="px-4 py-3 text-left text-sm font-semibold">ID</th>
                                                <th className="px-4 py-3 text-left text-sm font-semibold">Тип</th>
                                                <th className="px-4 py-3 text-left text-sm font-semibold">Даты</th>
                                                <th className="px-4 py-3 text-right text-sm font-semibold">Jabka</th>
                                                <th className="px-4 py-3 text-right text-sm font-semibold">Amazon</th>
                                                <th className="px-4 py-3 text-right text-sm font-semibold">Разница</th>
                                                <th className="px-4 py-3 text-left text-sm font-semibold">Файл</th>
                                                <th className="px-4 py-3 text-left text-sm font-semibold">Лист</th>
                                                <th className="px-4 py-3 text-left text-sm font-semibold">Примечания</th>
                                            </tr>
                                        </thead>
                                        <tbody className="divide-y divide-gray-200">
                                            {results.map((row, idx) => (
                                                <tr key={idx} className={`hover:bg-gray-50 ${getStatusColor(row.status)}`}>
                                                    <td className="px-4 py-3">
                                                        <div className="flex items-center gap-2">
                                                            {getStatusIcon(row.status)}
                                                            <span className="text-sm font-medium">{row.status}</span>
                                                        </div>
                                                    </td>
                                                    <td className="px-4 py-3 text-sm font-mono">{row.idValue}</td>
                                                    <td className="px-4 py-3 text-sm">
                                                        <span className={`px-2 py-1 rounded text-xs font-medium ${
                                                            row.isTrip ? 'bg-blue-100 text-blue-700' : 'bg-purple-100 text-purple-700'
                                                        }`}>
                                                            {row.isTrip ? 'Trip' : 'Load'}
                                                        </span>
                                                    </td>
                                                    <td className="px-4 py-3 text-xs">
                                                        {row.startDate && row.endDate ? 
                                                            `${row.startDate.toLocaleDateString()} - ${row.endDate.toLocaleDateString()}` : 
                                                            'N/A'
                                                        }
                                                    </td>
                                                    <td className="px-4 py-3 text-sm text-right font-medium">
                                                        ${row.amount.toFixed(2)}
                                                    </td>
                                                    <td className="px-4 py-3 text-sm text-right font-medium">
                                                        ${row.amazonTotal.toFixed(2)}
                                                    </td>
                                                    <td className="px-4 py-3 text-sm text-right font-medium">
                                                        {row.difference > 0 ? `${row.difference.toFixed(2)}` : '-'}
                                                    </td>
                                                    <td className="px-4 py-3 text-xs text-gray-600">{row.foundInFile || '-'}</td>
                                                    <td className="px-4 py-3 text-xs text-gray-600">{row.foundOnSheet || '-'}</td>
                                                    <td className="px-4 py-3 text-sm text-gray-600">
                                                        {row.notes}
                                                        {row.matchedRows.length > 0 && (
                                                            <div className="text-xs mt-1 text-gray-500">
                                                                {row.matchedRows.join(', ')}
                                                            </div>
                                                        )}
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        ReactDOM.render(<PaymentReconciliation />, document.getElementById('root'));
    </script>
</body>
</html>
